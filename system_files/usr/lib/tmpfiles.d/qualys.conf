# Tmpfiles for Qualys Cloud Agent (bootc immutable OS)
# Runtime directories for writable data
# Permissions match what the original activation script sets

# Basic runtime dirs (770 for shared dirs, 700 for agent data)
d /var/log/qualys 0770 root root -
d /var/lib/qualys 0700 root root -
d /var/lib/qualys/cloud-agent 0700 root root -
d /var/cache/qualys 0700 root root -
d /var/spool/qualys 0770 root root -
d /run/qualys 0700 root root -

# Config directory (writable, 770 to match original script)
d /etc/qualys 0770 root root -
d /etc/qualys/cloud-agent 0700 root root -

# Writable data directories (symlinked from /usr/libexec/qualys/cloud-agent)
# These are created at boot and symlinked from the immutable agent directory
# Using 700 to match the original script's chmod 700 for INSTALL_MAIN_DIR
d /var/lib/qualys/cloud-agent/cert 0700 root root -
d /var/lib/qualys/cloud-agent/data 0700 root root -
d /var/lib/qualys/cloud-agent/cep 0700 root root -
d /var/lib/qualys/cloud-agent/cep/results 0700 root root -
d /var/lib/qualys/cloud-agent/custom-qid 0700 root root -
d /var/lib/qualys/cloud-agent/custom-qid/scripts 0700 root root -

# Root manifests directory and all module-specific manifest directories (writable for downloading manifests)
d /var/lib/qualys/cloud-agent/manifests 0700 root root -
d /var/lib/qualys/cloud-agent/cep/manifests 0700 root root -
d /var/lib/qualys/cloud-agent/correlation 0700 root root -
d /var/lib/qualys/cloud-agent/correlation/manifests 0700 root root -
d /var/lib/qualys/cloud-agent/custom-qid/manifests 0700 root root -
d /var/lib/qualys/cloud-agent/db-auth 0700 root root -
d /var/lib/qualys/cloud-agent/db-auth/manifests 0700 root root -
d /var/lib/qualys/cloud-agent/epp 0700 root root -
d /var/lib/qualys/cloud-agent/epp/manifests 0700 root root -
d /var/lib/qualys/cloud-agent/mux 0700 root root -
d /var/lib/qualys/cloud-agent/mux/manifests 0700 root root -
d /var/lib/qualys/cloud-agent/mux/bpf 0700 root root -
d /var/lib/qualys/cloud-agent/mux/bpf/manifests 0700 root root -
d /var/lib/qualys/cloud-agent/swca 0700 root root -
d /var/lib/qualys/cloud-agent/swca/manifests 0700 root root -
d /var/lib/qualys/cloud-agent/xdr 0700 root root -
d /var/lib/qualys/cloud-agent/xdr/manifests 0700 root root -

# Note: Config.db and writable directories are symlinked from /usr/libexec/qualys/cloud-agent
# to /var/lib/qualys/cloud-agent during the container build

