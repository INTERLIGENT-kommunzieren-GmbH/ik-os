# Tmpfiles for Qualys Cloud Agent (bootc immutable OS)
# Runtime directories and symlinks for writable data

# Basic runtime dirs
d /var/log/qualys 0755 root root -
d /var/lib/qualys 0755 root root -
d /var/lib/qualys/cloud-agent 0755 root root -
d /var/cache/qualys 0755 root root -
d /run/qualys 0755 root root -

# Writable data directory for agent database and runtime files
# The agent binary is in /usr/libexec/qualys/cloud-agent (immutable)
# But it needs to write Config.db and other files, so we symlink those to /var
d /var/opt 0755 root root -
d /var/opt/qualys 0755 root root -
d /var/opt/qualys/cloud-agent-data 0755 root root -

# Symlink Config.db from immutable location to writable location
# The agent will create Config.db in /usr/libexec/qualys/cloud-agent/Config.db
# but the symlink redirects writes to /var/opt/qualys/cloud-agent-data/Config.db
L+ /usr/libexec/qualys/cloud-agent/Config.db - - - - /var/opt/qualys/cloud-agent-data/Config.db

